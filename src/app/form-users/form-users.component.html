<main class="main">
  <section class="main__content nav-container">
    <form novalidate (ngSubmit)="save()" [formGroup]="customerForm">
      <!-- FIRST NAME -->
      <div class="container">
        <input class="container__input" id="firstNameId" type="text" placeholder="First Name (required)" formControlName="firstName"
          [ngClass]="{'is-invalid': (customerForm.get('firstName').touched ||
                                      customerForm.get('firstName').dirty) &&
                                      !customerForm.get('firstName').valid }" />
        <span class="invalid-feedback">
          <span *ngIf="customerForm.get('firstName').errors?.required && !customerForm.get('firstName').pristine">
            Please enter your first name.
          </span>
          <span *ngIf="customerForm.get('firstName').errors?.minlength && !customerForm.get('firstName').pristine">
            The first name must be longer than 3 characters.
          </span>
        </span>
        <label class="container__label" for="firstNameId">First Name</label>
      </div>
      <!-- LAST NAME -->
      <div class="container">
        <input class="container__input" id="lastNameId" type="text" placeholder="Last Name (required)" formControlName="lastName"
          [ngClass]="{'is-invalid': (customerForm.get('lastName').touched ||
                                              customerForm.get('lastName').dirty) &&
                                              !customerForm.get('lastName').valid }" />
        <span class="invalid-feedback">
          <span *ngIf="customerForm.get('lastName').errors?.required && !customerForm.get('lastName').pristine">
            Please enter your last name.
          </span>
          <span *ngIf="customerForm.get('lastName').errors?.maxlength && !customerForm.get('lastName').pristine">
            The last name must be less than 50 characters.
          </span>
        </span>
        <label class="container__label" for="lastNameId">Last Name</label>
      </div>

      <!-- EMAIL -->
      <div formGroupName="emailGroup">
        <div class="container">
          <input class="container__input" id="emailId" type="email" placeholder="Email (required)" formControlName="email" [ngClass]="{'is-invalid': emailMessage }"
          />
          <span class="invalid-feedback">
            {{ emailMessage }}
          </span>
          <label class="container__label" for="emailId">Email</label>
        </div>

        <div class="container">
          <input class="container__input" id="confirmEmailId" type="email" placeholder="Confirm Email (required)" formControlName="confirmEmail"
            [ngClass]="{'is-invalid': customerForm.get('emailGroup').errors ||
                                               ((customerForm.get('emailGroup.confirmEmail').touched || 
                                                customerForm.get('emailGroup.confirmEmail').dirty) && 
                                                !customerForm.get('emailGroup.confirmEmail').valid) }" />
          <span class="invalid-feedback">
            <span *ngIf="customerForm.get('emailGroup.confirmEmail').errors?.required && !customerForm.get('emailGroup.confirmEmail').prestine">
              Please confirm your email address.
            </span>
            <span *ngIf="customerForm.get('emailGroup').errors?.match && !customerForm.get('emailGroup.confirmEmail').prestine">
              The confirmation does not match the email address.
            </span>
          </span>
          <label class="container__label" for="confirmEmailId">Confirm Email</label>
        </div>
      </div>

      <!-- credit card -->
      <br />
      <br />
      <div id="form-container" class="form__credit__car">

        <div id="card-front">
          <div id="shadow"></div>
          <div id="image-container">
            <span id="amount">paying:
              <strong>$99</strong>
            </span>
            <span id="card-image">

            </span>
          </div>
          <!-- end card image container -->

          <label for="card-number">
            Card Number
          </label>
          <input type="text" id="card-number" placeholder="1234 5678 9101 1112" maxlength="16" formControlName="cardNumber" length="16">
          <p class="invalid-feedback-small" *ngIf="customerForm.get('cardNumber').errors?.required && !customerForm.get('cardNumber').pristine">Add Card Number</p>
          <div id="cardholder-container">
            <label for="card-holder">Card Holder
            </label>
            <input type="text" id="card-holder" placeholder="e.g. John Doe" formControlName="cardName" />
            <p class="invalid-feedback-small" *ngIf="customerForm.get('cardName').errors?.required && !customerForm.get('cardName').pristine">Add Name</p>
          </div>
          <!-- end card holder container -->
          <div id="exp-container">
            <label for="card-exp">
              Expiration
            </label>
            <input id="card-month" type="text" placeholder="MM" length="2" maxlength="2" formControlName="monthExpiration">
            <input id="card-year" type="text" placeholder="YY" length="2" maxlength="2" formControlName="yearExpiration">
            <p class="invalid-feedback-small" *ngIf="customerForm.get('yearExpiration').errors?.required && !customerForm.get('yearExpiration').pristine || customerForm.get('monthExpiration').errors?.required && !customerForm.get('monthExpiration').pristine">Add 2 digits</p>
          </div>
          <div id="cvc-container">
            <label for="card-cvc"> CVC/CVV</label>
            <p class="invalid-feedback-small" *ngIf="customerForm.get('cardCvc').errors?.required && !customerForm.get('cardCvc').pristine">Add 3 or 4 digits</p>
            <input id="card-cvc" placeholder="XXX-X" type="text" minlength="3" maxlength="4" formControlName="cardCvc">
            <p>Add 3 or 4 digits</p>
          </div>
          <!-- end CVC container -->
          <!-- end exp container -->
        </div>
        <!-- end card front -->
        <div id="card-back">
          <div id="card-stripe">
          </div>

        </div>
        <!-- end card back -->
        <input type="text" id="card-token" />
      </div>
      <!-- credit card -->

      <div class="form-group row mb-2">
        <div class="form__center">
          <button class="form__submit" type="submit" style="width:80px" [title]="customerForm.valid ? 'Save your entered data' : 'Disabled until the form data is valid'"
            [disabled]="!customerForm.valid">
            Save
          </button>
          <button class="form__submit" type="button" (click)="populateTestData()">
            Test Data
          </button>
        </div>
      </div>
    </form>
  </section>
  <aside class="main__sidebar">
    <ul>
      <li>Dirty: {{ customerForm.dirty }}</li>
      <li>Touched: {{ customerForm.touched }}</li>
      <li>Valid: {{ customerForm.valid }}</li>
      <li>Pristine: {{ customerForm.pristine }}</li>
      <li>Value: {{ customerForm.value | json }}</li>
    </ul>
  </aside>
</main>